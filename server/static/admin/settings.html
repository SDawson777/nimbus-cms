<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Accessibility Settings â€” Nimbus Cannabis OS CMS</title>
    <link rel="stylesheet" href="/styles.css" />
    <style>
      .settings {
        max-width: 720px;
        margin: 28px auto;
        padding: 18px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 10px;
      }
      .row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.02);
      }
      .controls {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      label {
        font-weight: 600;
      }
      .note {
        color: var(--muted);
        font-size: 0.9em;
      }
      .buttons {
        margin-top: 18px;
        display: flex;
        gap: 12px;
      }
    </style>
  </head>
  <body>
    <a class="skip-link" href="#settings">Skip to accessibility settings</a>
    <div class="container">
      <div class="site-top">
        <div class="brand">
          <img class="logo" src="/nimbus-logo.svg" alt="Nimbus Cannabis OS CMS logo" />
          <strong>Nimbus Cannabis OS CMS</strong>
        </div>
        <div class="nav">
          <a class="card" href="/admin/dashboard">Dashboard</a>
          <a class="card" href="/admin/logout">Sign out</a>
        </div>
      </div>
      <div id="settings" class="settings">
        <h2>Accessibility settings</h2>
        <p class="note">
          These preferences are saved in your browser for this device. Use them to make the admin UI
          easier to use.
        </p>

        <div class="row">
          <div>
            <label for="contrast">High contrast</label>
            <div class="note">Increase contrast for readability.</div>
          </div>
          <div class="controls">
            <input id="contrast" type="checkbox" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="large">Large text</label>
            <div class="note">Increase font size across the admin UI.</div>
          </div>
          <div class="controls">
            <input id="large" type="checkbox" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="dyslexic">Dyslexia-friendly font</label>
            <div class="note">Use a dyslexia-friendly font and spacing.</div>
          </div>
          <div class="controls">
            <input id="dyslexic" type="checkbox" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="reduceMotion">Reduce motion</label>
            <div class="note">Disable animations for motion sensitivity.</div>
          </div>
          <div class="controls">
            <input id="reduceMotion" type="checkbox" />
          </div>
        </div>

        <div class="buttons">
          <button id="save">Save</button>
          <button id="reset">Reset to defaults</button>
          <button id="export">Export prefs</button>
        </div>

        <pre id="out" style="margin-top: 12px; color: var(--muted); display: none"></pre>
      </div>
    </div>

    <div
      class="a11y-widget"
      aria-hidden="false"
      style="position: fixed; right: 12px; bottom: 12px; z-index: 999"
    >
      <button id="a11y-contrast" title="Toggle high contrast" aria-pressed="false">Contrast</button>
      <button id="a11y-large" title="Toggle large text" aria-pressed="false">Large text</button>
      <button id="a11y-dyslexic" title="Toggle dyslexia-friendly font" aria-pressed="false">
        Dyslexic
      </button>
    </div>

    <script src="/a11y.js"></script>
    <script>
      ;(function () {
        function $(id) {
          return document.getElementById(id)
        }
        const inputs = ['contrast', 'large', 'dyslexic', 'reduceMotion'].map((id) => $(id))

        function loadUI() {
          const prefs =
            (window.NIMBUS_A11Y && window.NIMBUS_A11Y.getPrefs && window.NIMBUS_A11Y.getPrefs()) || {}
          $('contrast').checked = !!prefs.contrast
          $('large').checked = !!prefs.large
          $('dyslexic').checked = !!prefs.dyslexic
          $('reduceMotion').checked = !!prefs.reduceMotion
        }

        function writeOut(obj) {
          const out = $('out')
          out.textContent = JSON.stringify(obj, null, 2)
          out.style.display = 'block'
        }

        document.addEventListener('DOMContentLoaded', function () {
          loadUI()

          $('save').addEventListener('click', function () {
            const prefs = {
              contrast: $('contrast').checked,
              large: $('large').checked,
              dyslexic: $('dyslexic').checked,
              reduceMotion: $('reduceMotion').checked,
            }
            if (window.NIMBUS_A11Y && window.NIMBUS_A11Y.setPrefs) window.NIMBUS_A11Y.setPrefs(prefs)
            writeOut(prefs)
          })

          $('reset').addEventListener('click', function () {
            if (window.NIMBUS_A11Y && window.NIMBUS_A11Y.reset) window.NIMBUS_A11Y.reset()
            loadUI()
            writeOut(window.NIMBUS_A11Y.getPrefs())
          })

          $('export').addEventListener('click', function () {
            const p = window.NIMBUS_A11Y.getPrefs()
            const blob = new Blob([JSON.stringify(p, null, 2)], {type: 'application/json'})
            const url = URL.createObjectURL(blob)
            const a = document.createElement('a')
            a.href = url
            a.download = 'nimbus-a11y-prefs.json'
            a.click()
            URL.revokeObjectURL(url)
          })
        })
      })()
    </script>
  </body>
</html>
